
<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">

  <title>Admin Dashboard</title>

  <link href="https://templates.essaywpthemes.com/order/public/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://kit.fontawesome.com/116a312519.js" crossorigin="anonymous"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500&family=Lato:wght@400;700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

  <script src="https://templates.essaywpthemes.com/order/public/bootstrap/js/jquery.min.js"></script>
  <script src="https://templates.essaywpthemes.com/order/public/bootstrap/js/bootstrap.min.js"></script>
  <!-- Custom fonts for this template -->
  <script src="https://kit.fontawesome.com/f53431686e.js" crossorigin="anonymous"></script>
  <script src="https://kit.fontawesome.com/116a312519.js" crossorigin="anonymous"></script>

  <!-- Custom styles for this template -->
  <link href="https://templates.essaywpthemes.com/order/public/admin/freelancer.css" rel="stylesheet">
  <style>
    table {
      width: 100%;
      border-collapse: collapse;
    }

    th, td {
      padding: 8px;
      text-align: left;
      vertical-align: top;
    }

    th {
      background-color: #eee;
    }

    tr:nth-child(even) td {
      background-color: #ffffff;
    }
  </style>
</head>

<body id="page-top">

  <!-- Navigation -->
  {% include 'admindash/partials/adminnavbar.html' %}
  <!-- Navigation -->   <!-- Portfolio Grid Section -->
    <section class="" id="portfolio">
      <div class="container">
        <div class="row">

          {% include 'admindash/partials/adminsidenavbar.html' %}



          <div class="col-sm-10">

            <div class="row text-center service-menu-background">

              <div class="col-sm-1">
                <a href="{% url 'adminpending' %}" class="orders-menu">
                  Pending <span class="header-badge grey"> {{not_paid_count}} </span>
                </a>
              </div>
              <!--
              <div class="col-sm-1"><a href="https://templates.essaywpthemes.com/order/adorders/urgent">
                  <i class="fa fa-fire" aria-hidden="true"></i> Urgent (<font color="#e60000">1</font>)</a>
              </div>
              <div class="col-sm-1"><a href="https://templates.essaywpthemes.com/order/adorders/aurgent">
                  <i class="fa fa-fire" aria-hidden="true"></i><br /> Urgent assigned(<font color="#e60000">0</font>)</a>
              </div>
              <div class="col-sm-1"><a href="https://templates.essaywpthemes.com/order/adorders/bids">
                  <i class="fa fa-fire" aria-hidden="true"></i> <br />Bids (<font color="#e60000">0</font>)</a>
              </div>
              -->
          
              <div class="col-sm-1">
                <a href="{% url 'adminavailable' %}" class="orders-menu">
                  Available <span class="header-badge grey"> {{approved_orders_count}} </a>
                      
              </div>
              
              <div class="col-sm-1">
                <a href="{% url 'adminprogress' %}" class="orders-menu">
                  Progress <span class="header-badge grey"> {{progress_orders_count}}  </a>
              </div>
              <div class="col-sm-1">
                <a href="{% url 'adminediting' %}" class="orders-menu">
                  Editing <span class="header-badge grey"> {{editing_orders_count}} </a>
                      
              </div>
             
              <div class="col-sm-1">
                <a href="{% url 'admincompleted' %}" class="orders-menu">
                  Completed <span class="header-badge grey">{{completed_orders_count}}     </a>
              </div>
              <div class="col-sm-1">
                <a href="{% url 'adminrevision' %}" class="orders-menu">
                  Revision <span class="header-badge grey">{{revision_orders_count}}       </a>
              </div>
              <div class="col-sm-1">
                <a href="{% url 'admincancelled' %}" class="orders-menu">
                  Cancelled <span class="header-badge grey"> {{cancelled_orders_count}}    </a>
              </div>
          
              <div class="col-sm-1">
                  <a href="{% url 'adminavailable' %}" class="orders-menu">
                    Approved <span class="header-badge grey"> {{approved_orders_count}} </a>
                        
                </div>
            </div>

  <!--
  <div class="row search-box">
    
        <div class="col-sm-4">

      <form action="https://templates.essaywpthemes.com/order/adorders/getid" method="post" class="row">
        <input name="searchid" class="col-sm-9 form-control border-default" placeholder="Search order by ID" type="text">
        <button type="submit"><i class="fas fa-search"></i></button>
      </form>

    </div>
    <div class="col-sm-6">
      <form action="https://templates.essaywpthemes.com/order/adorders/search_url_create" method="post" class="row">
        <input name="search" class="col-sm-10 form-control border-default" placeholder="Search order by title/keyword" type="text" value="">
        <button type="submit"><i class="fas fa-search"></i></button>
      </form>
    </div>
    <div class="col-sm-1"><a class="btn btn-info" href="https://templates.essaywpthemes.com/order/adorders/bidding">Clear search</a></div>


  </div>

  <hr />
   --> <link rel="stylesheet" type="text/css" href="https://templates.essaywpthemes.com/order/public/dropzone/basic.min.css">
 <script type="text/javascript" src="https://templates.essaywpthemes.com/order/public/dropzone/jquery.js"></script>
 <script type="text/javascript" src="https://templates.essaywpthemes.com/order/public/dropzone/dropzone.min.js"></script>

 {% if messages %}
<ul class="messages">
{% for message in messages %}
<li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
{% endfor %}
</ul>
{% endif %}
 <div class="row">

  

   <div class="col-sm-8 main-content">
                      

     <div class="row search-box">

       <div class="col-sm-8">


         <h5 class="topictitle">{{order.title}} </h5>

          <span class="deds">
             <y href="#" data-toggle="tooltip" class="" title="First Order">{{order.academic_level}}</y>
           </span>
         

       </div>


        <div class="col-sm-2">
           <a class="btn btn-warning" href="{% url 'adminedit_order' order.id %}">Edit Order </a>
         </div>        <div class="col-sm-2">

          {% if order.status == 'Bidding' %}

         <a class="btn btn-info" href="{% url 'adminorder_bids' order.id %}"> Bids ({{bids_count}})</a>
         {% endif %}
         
       </div>

     </div>
     <div class="row search-box">

       <div class="col-sm-6">

         <table class="table table-sm">
           <tbody>
             

             <tr>
               <th scope="row">Paper Type:</th>
               <td>{{order.order_type}}</td>
             </tr>
             <tr>
               <th scope="row">Client ID:</th>
               <td>
                                                     <a href="https://templates.essaywpthemes.com/order/adclients/view/136">136</a>
                 

               </td>
             </tr>
             <tr>
               <th scope="row">Subject:</th>
               <td> {{order.subject_area}}</td>
             </tr>
             <tr>
               <th scope="row">Pages</th>
               <td>{{order.pages}} ( )</td>
             </tr>
             <tr>
               <th scope="row">Sources</th>
               <td>{{order.sources}} </td>
             </tr>

            
             <tr>
               <th scope="row">Spacing</th>
               <td>{{order.spacing}} </td>
             </tr>
             


             <tr>
               <th scope="row">Citation</th>
               <td>{{order.style}}</td>
             </tr>

              <tr>
               <th scope="row">Subject Area</th>
               <td>{{order.subject_area}}</td>

              </tr>

              <tr>
                <th scope="row">Language</th>
                <td> {{order.language}}</td>
              </tr>

              <tr>
                <th scope="row">Country</th>
                <td>Pakistan</td>
              </tr>

             </tr>
           </tbody>
         </table>
       </div>

       <div class="col-sm-6">


         <table class="table table-sm">
           <tbody>
             <tr>
               <th scope="row">Academic Level</th>
               <td>{{order.academic_level}}</td>
             </tr>
             <tr>
               <th scope="row">Quality</th>
               <td>{{order.writer_level}}</td>
             </tr>
                            <tr>
                 <th scope="row">Total Amnt</th>
                 <td>USD {{order.price}}</td>
               </tr>
                          <tr>
               <th scope="row">Writer Amnt</th>
               <td> USD {{order.writer_amount}}</td>
             </tr>
             <tr>
               <th scope="row">Editors Amnt</th>
               <td> USD {{order.editor_amount}}</td>
             </tr>
             <tr>
              <th scope="row">Net Amnt</th>
              <td> USD {{order.net_amount}}</td>
            </tr>
            <tr>
              <th scope="row">Date Posted</th>
              <td>{{order.Submissiondate}}</td>

             <tr>
               <th scope="row">Deadline Date</th>
               <td> {{order.deadline}}</td>
             </tr>
             
             <tr>
               <th scope="row">Writer</th>
               <td> 0
                 ()


               </td>
             </tr>
             <tr>
               <th scope="row">Order Editor</th>
               <td> 0
                 ()

               </td>
             </tr>
            
           </tbody>
         </table>

       </div>

     </div>

     <hr />
     <div class="row search-box">

       <div class="col-sm-3">Time left</div>

       <div class="col-sm-6 alert alert-info">

         <font color='red'>-1 days 13 hours 50 minutes passed </font><br/><font color='red'>-1 days 23 hours 50 minutes passed </font> <br/></div>

       <div class="col-sm-3">


         
           <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModalw">
             Adjust time
           </button>


           <!-- Modal -->
           <div class="modal fade" id="exampleModalw" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
             <div class="modal-dialog" role="document">
               <div class="modal-content">
                 <div class="modal-header">
                   <h5 class="modal-title" id="exampleModalLabel">Adjust Time</h5>
                   <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                     <span aria-hidden="true">&times;</span>
                   </button>
                 </div>
                 <div class="modal-body">
                   <link rel="stylesheet" type="text/css" href="https://templates.essaywpthemes.com/order/public/datepicker/jquery.css">
                   <script src="https://templates.essaywpthemes.com/order/public/datepicker/jquery_002.js"></script>

                   <!-- Place this tag in your head or just before your close body tag. -->
                   <script src="https://templates.essaywpthemes.com/order/public/datepicker/jquery.js"></script>
                   <script src="https://templates.essaywpthemes.com/order/public/bootstrap/js/bootstrap.min.js"></script>
                   <form role="form" action="https://templates.essaywpthemes.com/order/adorders/changetime/70142" method="POST">
                     <input value="70142" name="order_id" class="border-default form-control" type="hidden">
                     <div class="input-group-btn">

                       Current client's deadline: 2023-03-09 17:44:33                       <hr />

                     </div>

                     <div class="form-group row">
                       <label for="staticEmail" class="col-sm-4 col-form-label">Client's Time</label>
                       <div class="col-sm-8">
                         <input id="datetimepicker1" name="order_deadline" value="2023-03-09 17:44:33" class="border-default form-control" type="text">
                       </div>
                     </div>
                     <div class="form-group row">
                       <label for="inputPassword" class="col-sm-4 col-form-label">Writer's Time</label>
                       <div class="col-sm-8">
                         <input id="datetimepicker2" name="order_wrdeadline" value="2023-03-09 07:44:33" class="border-default form-control" type="text">
                       </div>
                     </div>




                     <script>
                       $(function() {
                         $('#datetimepicker1').datetimepicker({
                           minDate: new Date()
                         });
                         $('#datetimepicker2').datetimepicker({
                           minDate: new Date()
                         });
                       });
                     </script>
                     <button class="btn btn-info">Adjust time</button>
                   </form>
                   <script type="text/javascript">
                     $('#datetimepicker1').datetimepicker({
                       format: 'Y-m-d H:i',
                     });
                   </script>
                 </div>
               </div>
             </div>
           </div>


                </div>
     </div>
     

     <hr />


     <div class="row search-box">

        <div class="col-sm-12">
         <h6> Paper details </h6>
         {{order.description|safe}}   
         
         <div>
          <h6> Order Files </h6>
          
          <table class="table table-striped table-advance table-hover">
            {% if writerfilescount != 0 %}
            <tbody>
              
              <tr>
                <th><i class="icon_document_alt"></i> File Name</th>
                <th><i class="icon_profile"></i> Date</th>
              </tr>
              {% for file in files %}
              <tr>
               
                <td>
                  <a href="{{file.file.url}}" download target="_blank">{{file.file}} <i class="fa fa-download"></i></a>
                </td>
               
                <td>{{file.uploaded_at}}</td>
              </tr>
              {% endfor %}
            </tbody>
            {% endif %}
          </table>
          <div class="row">
          </div>

         </div>
         
         <div>
          <h6> Writer Files </h6>
          
          <table class="table table-striped table-advance table-hover">
            {% if writerfilescount != 0 %}
            <tbody>
              
              <tr>
                <th><i class="icon_document_alt"></i> File Name</th>
                <th><i class="icon_document_alt"></i> Status</th>
                <th><i class="icon_profile"></i> Date</th>
              </tr>
              {% for file in writerfiles %}
              <tr>
               
                <td>
                  <a href="{{file.file.url}}" download target="_blank">{{file.file}} <i class="fa fa-download"></i></a>
                </td>
                <td>
                  {{file.file_status}}</a>
                </td>
                <td>{{file.created_at}}</td>
              </tr>
              {% endfor %}
            </tbody>
            {% endif %}
          </table>
          <div class="row">
          </div>

         </div>
        </div>
        
     </div>
     <hr />

     <div class="row search-box">
      
       <div class="col">
        
         {% if order.status == "Editing" %}
         <h6> Client Files </h6>
         <p class="text-center"> Upload client files here </p>
         <div class="row"> 
          
           <div class="col-sm-6 mb-3">
            
           </div>
           <div class="col-sm-12 text-center">
             <button type="button" class="btn btn-success" data-toggle="modal" data-target="#uploadModal">
               Upload File <i class="fas fa-upload"></i>
             </button>
           </div>
           
         </div>
           
         {% endif %} 

          <!-- file upload modal -->
          <div class="modal fade" id="uploadModal" tabindex="-1" role="dialog" aria-labelledby="uploadModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
              <div class="modal-content">
                <form id="uploadForm" method="post" enctype="multipart/form-data" action="{% url 'admin_upload_files' order.id %}">
                  {% csrf_token %}
                  <div class="modal-header">
                    <h5 class="modal-title" id="uploadModalLabel">Upload File</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                  <div class="modal-body">
                    <div class="form-group">
                      <label for="file">File</label>
                      <input type="file" class="form-control-file" id="file" name="file">
                    </div>
                    <div class="form-group">
                      <label for="file_status">Status</label>
                      <select class="form-control" id="file_status" name="file_status">
                        <option value="draft">Draft</option>
                        <option value="final">Final</option>
                      </select>
                    </div>
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    <button type="submit" class="btn btn-success">Upload</button>
                  </div>
                </form>
              </div>
            </div>
          </div>

       </div>
       <div class="col">
        {% for file in adminfiles %}

          <h6> Uploaded Files ({{ adminfilescount }})</h6>
          <hr />

          <table class="table table-striped table-advance table-hover">
            <tbody>
              
                <tr>
                  <th><i class="icon_document_alt"></i> File Name</th>
                </tr>
                <tr>
                  <td>
                    <a href="{{file.file.url}}" download target="_blank"> {{file.file}} - {{file.file_status}} - {{file.created_at}}<i class="fa fa-download"></i></a>
                  </td>
                </tr>
              
            </tbody>
          </table>
          {% endfor %}
       </div>

       <div class="col-lg-12">
        <section class="panel">

          
          <h3 class="text-center text-danger">Tracking History</h3>
          <table class="table table-striped table-advance table-hover">
              <tbody>
              <tr>
                 
                  <th><i class="icon_profile"></i> Status</th>
        
                  <th><i class="icon_calendar"></i> Time Stamp</th>
              </tr>
              {% for i in  statustracking  %}
              <tr>
                  <td>{{i.new_status}}</td>
                  <td>{{i.date}}</td>

              </tr>
              {% endfor %}

              </tbody>
          </table>
          


        </section>
    </div>
     </div>


    

   </div>

  
   <div class="col-sm-4">
     <div class="orderformback search-box">
      <div class="">

        <div class="col"> <a class="btn col btn-warning"> Status: {{order.status}} </a></div>
        <hr />
        <h5>ORDER ID # {{order.orderNo}}</h5>
      </div>


      <div class="chat-box-div">
        <div class="alert alert-info">
            CHAT HISTORY
        </div>
        <form role="form" action="{% url 'order_chat' order_id=order.id %}" method="POST" id="chat-form">
            {% csrf_token %}
            <input type="hidden" name="msg_orderid" value="{{ order.id }}" readonly>
            <input type="hidden" name="msg_senderid" value="{{ request.user.id }}" readonly>
            <input type="hidden" name="order_clientid" value="{{ order.client.id }}" readonly>
            <input type="hidden" name="order_writer" value="{% if order.writer %}{{ order.writer.id }}{% else %}0{% endif %}" readonly>
            <input type="hidden" name="msg_sendername" value="{{ request.user.username }}" readonly>
            <div class="chat-box-footer">
                <div class="form-group">
                    <select name="msg_to" class="border-default custom-select" id="msg-to" required>
                        <option value="">Message to Select</option>
                        <option value="writer">Writer</option>
                        <option value="client">Client</option>
                        <option value="support">Support/Editor</option>
                    </select>
                </div>
                <div class="form-group">
                    <textarea class="form-control" name="msg_body" id="msg-body" required></textarea>
                </div>
                <div class="input-group text-right">
                    <span class="input-group-btn">
                        <button class="btn btn-info" type="submit" id="send-message-btn">SEND</button>
                    </span>
                </div>
            </div>
        </form>
        <div class="panel-body chat-box-main">
            {% for message in chat_history %}
                {% if message.sender == request.user %}
                    <div class="chat-box-right">
                        <div class="chat-box-right-text">
                            <p>{{ message.sender_type}}  to {{ message.recipient_type}}</p>
                            <p>{{ message.body }}</p>
                            <span class="chat-box-right-time">{{ message.timestamp|date:"F d, Y H:i A" }}</span>
                        </div>
                        
                    </div>
                {% else %}
                    <div class="chat-box-left">
                       
                        <div class="chat-box-left-text">
                            <p>{{ message.body }}</p>
                            <span class="chat-box-left-time">{{ message.timestamp|date:"F d, Y H:i A" }}</span>
                        </div>
                    </div>
                {% endif %}
            {% empty %}
                <p>No chat history yet.</p>
            {% endfor %}
        </div>
    </div>
        
       


       
      
     </div>
   </div>


   <script>
    $(document).ready(function() {
         // Scroll chat messages to top
            $('.chat-box-main').scrollTop(0);
        // Submit form using AJAX
        $('#chat-form').on('submit', function(e) {
            e.preventDefault();
            var form = $(this);
            var url = form.attr('action');
            var formData = form.serialize();
            $.ajax({
                url: url,
                type: 'POST',
                data: formData,
                success: function(response) {
                    $('#msg-body').val(''); // Clear message input field
                    $('#msg-to').val(''); // Clear message recipient field
                    $('.chat-box-main').append(response); // Append new message to chat box
                    $('.chat-box-main').scrollTop($('.chat-box-main')[0].scrollHeight); // Scroll chat messages to bottom
                },
                error: function(xhr, errmsg, err) {
                    console.log(xhr.status + ": " + xhr.responseText); // Log error to console
                }
            });
        });

        // Poll server for new messages every 5 seconds
        setInterval(function() {
            var lastMessageId = $('.chat-box-main .chat-box:last-child').data('message-id');
            var url = "{% url 'order_chat' order_id=order.id %}?last_message_id=" + lastMessageId;
            $.ajax({
                url: url,
                type: 'GET',
                success: function(response) {
                    if (response) {
                      $('.chat-box-main').append(response); // Append new message to chat box
                    $('.chat-box-main').scrollTop(0); // Scroll chat messages to top
                    }
                },
                error: function(xhr, errmsg, err) {
                    console.log(xhr.status + ": " + xhr.responseText); // Log error to console
                }
            });
        }, 5000);
    });
</script>

   <script type="text/javascript">
     calculate = function() {
       var resources = document.getElementById('a1').value;
       var minutes = document.getElementById('a2').value;
       document.getElementById('a3').value = parseInt(resources) * parseInt(minutes);

     }
   </script>




 </div>






 </div>

 </div>


 </div>
 </section>



 </body>

 </html>